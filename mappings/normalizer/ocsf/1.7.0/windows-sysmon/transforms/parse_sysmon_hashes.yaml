schema_version: "pa.transform.v0.1"
id: "parse_sysmon_hashes"
type: "parse_kv_list"
params:
  pair_delimiter: ","
  kv_delimiter: "="
  key_trim: true
  value_trim: true
  absent_sentinels: ["", "-", "(null)"]
  # Recognized keys to OCSF Fingerprint.algorithm_id
  algorithm_id_map:
    MD5: 1
    SHA1: 2
    SHA-1: 2
    SHA256: 3
    SHA-256: 3
    SHA512: 4
    SHA-512: 4
  unknown_algorithm_id: 99
  # Output contract:
  # - Emits a list of Fingerprint objects:
  #     [{algorithm_id, algorithm?, value}]
  # - The mapping layer MUST:
  #     - de-duplicate by (algorithm_id, value)
  #     - sort by (algorithm_id ASC, value ASC)

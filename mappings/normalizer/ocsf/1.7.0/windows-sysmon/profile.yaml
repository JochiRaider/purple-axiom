# mappings/normalizer/ocsf/1.7.0/windows-sysmon/profile.yaml
format_version: 1

profile:
  profile_id: windows-sysmon_to_ocsf_1.7.0
  profile_version: 0.1.0
  ocsf_version: "1.7.0"

source:
  source_pack_id: windows-sysmon
  event_source_type: windows-sysmon
  provider: Microsoft-Windows-Sysmon
  channel: Microsoft-Windows-Sysmon/Operational
  product_name: sysmon
  log_name: Microsoft-Windows-Sysmon/Operational

inputs:
  raw_shape_version: 1
  required_fields:
    - provider
    - channel
    - event_id
    - record_id
    - time_created
    - computer
    - event_data

includes:
  canonicalization: canonicalization.yaml
  routing: routing.yaml

shared_emit:
  time:
    from: time_created
    transforms: [parse_rfc3339_to_epoch_ms]

  device.name:
    from: computer
    transforms: [trim_ascii]

  device.hostname:
    from: computer
    transforms: [trim_ascii, lowercase_ascii]

  metadata.source_type:
    const: windows-sysmon

  metadata.source_event_id:
    from: record_id
    transforms: [to_string]

  metadata.identity_tier:
    const: 1

  metadata.log_provider:
    from: provider
    transforms: [trim_ascii]

  metadata.log_name:
    from: channel
    transforms: [trim_ascii]

  metadata.product.name:
    const: sysmon

identity:
  algorithm: "pa:eid:v1"
  identity_source_type: sysmon
  basis:
    source_type_const: sysmon
    origin.host_from: computer
    origin.channel_from: channel
    origin.provider_from: provider
    origin.record_id_from: record_id
    origin.event_id_from: event_id
  prehash_normalization:
    origin.host: [trim_ascii, lowercase_ascii]
    origin.channel: [trim_ascii, lowercase_ascii]
    origin.provider: [trim_ascii, lowercase_ascii]
    origin.record_id: [to_string]
    origin.event_id: [to_string]

outputs:
  set_uid_equal_event_id: true

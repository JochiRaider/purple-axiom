# mappings/normalizer/ocsf/1.7.0/windows-sysmon/classes/network_activity_4001.yaml
format_version: 1

class_map:
  class_uid: 4001
  class_name: Network Activity
  category_uid: 4

  event_id_map:
    3: {activity_id: 1}

emit:
  class_uid:
    const_from_class: true

  activity_id:
    from_event_id_map: activity_id

  type_uid:
    op: compute_type_uid
    args:
      class_uid_from_class: true
      activity_id_from_event_id_map: true

  actor.user.name:
    from: event_data.User
    transforms: [trim_ascii, absent_if_placeholder, split_domain_user_name]

  actor.user.domain:
    from: event_data.User
    transforms: [trim_ascii, absent_if_placeholder, split_domain_user_domain]

  actor.process.pid:
    from: event_data.ProcessId
    transforms: [trim_ascii, absent_if_placeholder, parse_int]

  actor.process.uid:
    from: event_data.ProcessGuid
    transforms: [trim_ascii, absent_if_placeholder]

  actor.process.file.path:
    from: event_data.Image
    transforms: [trim_ascii, absent_if_placeholder]

  src_endpoint.ip:
    from: event_data.SourceIp
    transforms: [trim_ascii, absent_if_placeholder]

  src_endpoint.port:
    from: event_data.SourcePort
    transforms: [trim_ascii, absent_if_placeholder, parse_int]

  dst_endpoint.ip:
    from: event_data.DestinationIp
    transforms: [trim_ascii, absent_if_placeholder]

  dst_endpoint.port:
    from: event_data.DestinationPort
    transforms: [trim_ascii, absent_if_placeholder, parse_int]

  dst_endpoint.hostname:
    from: event_data.DestinationHostname
    transforms: [trim_ascii, absent_if_placeholder]

  extensions.purple.sysmon.protocol:
    from: event_data.Protocol
    transforms: [trim_ascii, absent_if_placeholder]

{
  "registry_version": "0.1.0",
  "contracts": [
    {
      "contract_id": "audit_event",
      "schema_path": "docs/contracts/audit_event.schema.json",
      "contract_version": "0.2.0",
      "purpose": "Audit event row schema (control/audit.jsonl; reused by workspace logs/ui_audit.jsonl in v0.2).",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "baseline_detection_package_manifest",
      "schema_path": "docs/contracts/baseline_detection_package_manifest.schema.json",
      "contract_version": "0.2.0",
      "purpose": "Manifest for a Baseline Detection Package stored under exports/baselines/<baseline_id>/<baseline_version>/baseline_package_manifest.json.",
      "artifact_kind": "other",
      "format": "json"
    },
    {
      "contract_id": "bridge_compiled_plan",
      "schema_path": "docs/contracts/bridge_compiled_plan.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Sigma-to-OCSF bridge compiled plan per rule (bridge/compiled_plans/<rule_id>.plan.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "bridge_coverage",
      "schema_path": "docs/contracts/bridge_coverage.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Bridge coverage summary (bridge/coverage.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "bridge_mapping_pack",
      "schema_path": "docs/contracts/bridge_mapping_pack.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Sigma-to-OCSF bridge mapping pack snapshot (bridge/mapping_pack_snapshot.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "bridge_router_table",
      "schema_path": "docs/contracts/bridge_router_table.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Sigma logsource router table snapshot (bridge/router_table.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "cache_provenance",
      "schema_path": "docs/contracts/cache_provenance.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Run-level cache provenance evidence (logs/cache_provenance.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "cleanup_verification",
      "schema_path": "docs/contracts/cleanup_verification.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Cleanup verification results per action (runner/actions/<action_id>/cleanup_verification.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "counters",
      "schema_path": "docs/contracts/counters.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Run-level counters and gauges snapshot (logs/counters.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "criteria_entry",
      "schema_path": "docs/contracts/criteria_entry.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-line schema for criteria/criteria.jsonl.",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "criteria_pack_manifest",
      "schema_path": "docs/contracts/criteria_pack_manifest.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Criteria pack manifest snapshot (criteria/manifest.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "criteria_result",
      "schema_path": "docs/contracts/criteria_result.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-line schema for criteria/results.jsonl.",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "defense_outcomes",
      "schema_path": "docs/contracts/defense_outcomes.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Defense outcomes model (embedded in report extensions).",
      "artifact_kind": "other",
      "format": "json"
    },
    {
      "contract_id": "detection_instance",
      "schema_path": "docs/contracts/detection_instance.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-line schema for detections/detections.jsonl.",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "evaluator_conformance_report",
      "schema_path": "docs/contracts/evaluator_conformance_report.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Evaluator conformance report output (CI harness artifact at artifacts/evaluator_conformance/<report_id>/report.json).",
      "artifact_kind": "other",
      "format": "json"
    },
    {
      "contract_id": "ground_truth",
      "schema_path": "docs/contracts/ground_truth.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-line schema for ground_truth.jsonl.",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "lab_inventory_snapshot",
      "schema_path": "docs/contracts/lab_inventory_snapshot.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Deterministic lab inventory snapshot (logs/lab_inventory_snapshot.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "manifest",
      "schema_path": "docs/contracts/manifest.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Run-level manifest (manifest.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "mapping_coverage",
      "schema_path": "docs/contracts/mapping_coverage.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Optional mapping coverage stats (normalized/mapping_coverage.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "mapping_profile_input",
      "schema_path": "docs/contracts/mapping_profile_input.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Mapping profile input YAML validation (mappings/normalizer/ocsf/**).",
      "artifact_kind": "repo_input",
      "format": "yaml"
    },
    {
      "contract_id": "mapping_profile_snapshot",
      "schema_path": "docs/contracts/mapping_profile_snapshot.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Normalization mapping profile snapshot (normalized/mapping_profile_snapshot.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "netflow_manifest",
      "schema_path": "docs/contracts/netflow_manifest.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Manifest enumerating netflow capture/log files for a run (placeholder contract; v0.1).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "ocsf_event_envelope",
      "schema_path": "docs/contracts/ocsf_event_envelope.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Minimal required OCSF + provenance for normalized events.",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "pcap_manifest",
      "schema_path": "docs/contracts/pcap_manifest.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Manifest enumerating pcap capture files for a run (placeholder contract; v0.1).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "principal_context",
      "schema_path": "docs/contracts/principal_context.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Run-level principal context evidence (runner/principal_context.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "range_config",
      "schema_path": "docs/contracts/range_config.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Range configuration input (snapshotted to inputs/range.yaml per run).",
      "artifact_kind": "run_artifact",
      "format": "yaml"
    },
    {
      "contract_id": "redaction_profile_set",
      "schema_path": "docs/contracts/redaction_profile_set.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Redaction profile set for export/share tooling.",
      "artifact_kind": "other",
      "format": "json"
    },
    {
      "contract_id": "report.schema",
      "schema_path": "docs/contracts/report.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Consolidated run report output (report/report.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "requirements_evaluation",
      "schema_path": "docs/contracts/requirements_evaluation.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-action requirements evaluation output (runner/actions/<action_id>/requirements_evaluation.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "resolved_inputs_redacted",
      "schema_path": "docs/contracts/resolved_inputs_redacted.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Redaction-safe resolved inputs evidence (runner/actions/<action_id>/resolved_inputs_redacted.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "runner_executor_evidence",
      "schema_path": "docs/contracts/runner_executor_evidence.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-action runner executor evidence (runner/actions/<action_id>/executor.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "side_effect_ledger",
      "schema_path": "docs/contracts/side_effect_ledger.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-action append-only side-effect ledger (runner/actions/<action_id>/side_effect_ledger.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "state_reconciliation_report",
      "schema_path": "docs/contracts/state_reconciliation_report.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Per-action state reconciliation report (runner/actions/<action_id>/state_reconciliation_report.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "summary",
      "schema_path": "docs/contracts/summary.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Scoring summary for scoring/summary.json.",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "telemetry_baseline_profile",
      "schema_path": "docs/contracts/telemetry_baseline_profile.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Telemetry baseline profile input (inputs/telemetry_baseline_profile.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "telemetry_validation",
      "schema_path": "docs/contracts/telemetry_validation.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Telemetry validation summary (logs/telemetry_validation.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    },
    {
      "contract_id": "threat_intel_indicator",
      "schema_path": "docs/contracts/threat_intel_indicator.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Threat intel indicator records (inputs/threat_intel/indicators.jsonl).",
      "artifact_kind": "run_artifact",
      "format": "jsonl"
    },
    {
      "contract_id": "threat_intel_pack_manifest",
      "schema_path": "docs/contracts/threat_intel_pack_manifest.schema.json",
      "contract_version": "0.1.0",
      "purpose": "Threat intel pack snapshot manifest (inputs/threat_intel/manifest.json).",
      "artifact_kind": "run_artifact",
      "format": "json"
    }
  ],
  "bindings": [
    { "artifact_glob": "bridge/compiled_plans/*.plan.json", "contract_id": "bridge_compiled_plan", "stage_owner": "detection", "validation_mode": "json_document" },
    { "artifact_glob": "bridge/coverage.json", "contract_id": "bridge_coverage", "stage_owner": "detection", "validation_mode": "json_document" },
    { "artifact_glob": "bridge/mapping_pack_snapshot.json", "contract_id": "bridge_mapping_pack", "stage_owner": "detection", "validation_mode": "json_document" },
    { "artifact_glob": "bridge/router_table.json", "contract_id": "bridge_router_table", "stage_owner": "detection", "validation_mode": "json_document" },
    { "artifact_glob": "control/audit.jsonl", "contract_id": "audit_event", "stage_owner": "orchestrator", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "criteria/criteria.jsonl", "contract_id": "criteria_entry", "stage_owner": "validation", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "criteria/manifest.json", "contract_id": "criteria_pack_manifest", "stage_owner": "validation", "validation_mode": "json_document" },
    { "artifact_glob": "criteria/results.jsonl", "contract_id": "criteria_result", "stage_owner": "validation", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "detections/detections.jsonl", "contract_id": "detection_instance", "stage_owner": "detection", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "ground_truth.jsonl", "contract_id": "ground_truth", "stage_owner": "runner", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "inputs/range.yaml", "contract_id": "range_config", "stage_owner": "orchestrator", "validation_mode": "yaml_document" },
    { "artifact_glob": "inputs/telemetry_baseline_profile.json", "contract_id": "telemetry_baseline_profile", "stage_owner": "orchestrator", "validation_mode": "json_document" },
    { "artifact_glob": "inputs/threat_intel/indicators.jsonl", "contract_id": "threat_intel_indicator", "stage_owner": "orchestrator", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "inputs/threat_intel/manifest.json", "contract_id": "threat_intel_pack_manifest", "stage_owner": "orchestrator", "validation_mode": "json_document" },
    { "artifact_glob": "logs/cache_provenance.json", "contract_id": "cache_provenance", "stage_owner": "orchestrator", "validation_mode": "json_document" },
    { "artifact_glob": "logs/counters.json", "contract_id": "counters", "stage_owner": "orchestrator", "validation_mode": "json_document" },
    { "artifact_glob": "logs/lab_inventory_snapshot.json", "contract_id": "lab_inventory_snapshot", "stage_owner": "lab_provider", "validation_mode": "json_document" },
    { "artifact_glob": "logs/telemetry_validation.json", "contract_id": "telemetry_validation", "stage_owner": "telemetry", "validation_mode": "json_document" },
    { "artifact_glob": "manifest.json", "contract_id": "manifest", "stage_owner": "orchestrator", "validation_mode": "json_document" },
    { "artifact_glob": "normalized/mapping_coverage.json", "contract_id": "mapping_coverage", "stage_owner": "normalization", "validation_mode": "json_document" },
    { "artifact_glob": "normalized/mapping_profile_snapshot.json", "contract_id": "mapping_profile_snapshot", "stage_owner": "normalization", "validation_mode": "json_document" },
    { "artifact_glob": "normalized/ocsf_events.jsonl", "contract_id": "ocsf_event_envelope", "stage_owner": "normalization", "validation_mode": "jsonl_lines" },
    { "artifact_glob": "raw/netflow/manifest.json", "contract_id": "netflow_manifest", "stage_owner": "telemetry", "validation_mode": "json_document" },
    { "artifact_glob": "raw/pcap/manifest.json", "contract_id": "pcap_manifest", "stage_owner": "telemetry", "validation_mode": "json_document" },
    { "artifact_glob": "report/report.json", "contract_id": "report.schema", "stage_owner": "reporting", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/cleanup_verification.json", "contract_id": "cleanup_verification", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/executor.json", "contract_id": "runner_executor_evidence", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/requirements_evaluation.json", "contract_id": "requirements_evaluation", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/resolved_inputs_redacted.json", "contract_id": "resolved_inputs_redacted", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/side_effect_ledger.json", "contract_id": "side_effect_ledger", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/actions/*/state_reconciliation_report.json", "contract_id": "state_reconciliation_report", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "runner/principal_context.json", "contract_id": "principal_context", "stage_owner": "runner", "validation_mode": "json_document" },
    { "artifact_glob": "scoring/summary.json", "contract_id": "summary", "stage_owner": "scoring", "validation_mode": "json_document" }
  ],
  "notes": [
    "contracts[].contract_version MUST be kept in sync with each schema file's contract_version const (enforced by validation/runtime).",
    "bindings[].artifact_glob values are run-relative (relative to the run bundle root; do not include the runs/<run_id>/ prefix).",
    "bindings[].stage_owner identifies the owning stage (or \"orchestrator\") for deterministic expected_outputs construction at the publish gate.",
    "Network sensor manifests (raw/pcap/manifest.json and raw/netflow/manifest.json) are v0.1 placeholder artifacts. They MAY be absent unless the corresponding telemetry source is enabled and implemented. These paths are reserved; changing them MUST be treated as a breaking change (version bump + migration guidance)."
  ]
}
